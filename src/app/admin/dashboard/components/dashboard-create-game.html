<h3 class="text-lg font-bold text-white mb-4">{{ t('dashboard.createGame.title') }}</h3>
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
    <div class="col-span-1">
      <div class="flex justify-between items-center mb-1">
        <label class="block text-xs text-gray-200">{{ t('dashboard.createGame.name') }} *</label>
        @if (!newGameConfig.name) {
          <span class="text-[10px] text-red-400 uppercase font-bold">{{ t('dashboard.createGame.required') }}</span>
        }
      </div>
      <input
        [(ngModel)]="newGameConfig.name"
        placeholder="Game Name"
        data-testid="game-name-input"
        [placeholder]="t('dashboard.createGame.phName')"
        class="w-full px-4 py-2 bg-gray-900/50 border rounded-lg text-white focus:outline-none mb-1"
        [class.border-red-500]="!newGameConfig.name"
        [class.border-gray-600]="newGameConfig.name"
        [class.focus:border-emerald-500]="newGameConfig.name"
      />
      <p class="text-[10px] text-gray-500 mb-3 italic">{{ t('dashboard.createGame.nameHint') }}</p>
    </div>

    <div class="col-span-1">
      <div class="flex justify-between items-center mb-1">
        <label class="block text-xs text-gray-200">{{ t('dashboard.createGame.playerLabel') }} *</label>
        @if (!newGameConfig.playerLabel) {
          <span class="text-[10px] text-red-400 uppercase font-bold">{{ t('dashboard.createGame.required') }}</span>
        }
      </div>
      <input
        [(ngModel)]="newGameConfig.playerLabel"
        placeholder="Player"
        data-testid="player-label-input"
        [placeholder]="t('dashboard.createGame.phPlayer')"
        class="w-full px-4 py-2 bg-gray-900/50 border rounded-lg text-white focus:outline-none mb-1"
        [class.border-red-500]="!newGameConfig.playerLabel"
        [class.border-gray-600]="newGameConfig.playerLabel"
        [class.focus:border-emerald-500]="newGameConfig.playerLabel"
      />
      <p class="text-[10px] text-gray-500 mb-3 italic">{{ t('dashboard.createGame.playerHint') }}</p>
    </div>

    <div>
      <div class="flex justify-between items-center mb-1">
        <label class="block text-xs text-gray-200">Gesamtanzahl Slots</label>
        <span class="text-xs font-bold text-emerald-400 font-mono">{{ newGameConfig.numPlayers }}</span>
      </div>
      <input
        [(ngModel)]="newGameConfig.numPlayers"
        (ngModelChange)="onPlayersChange()"
        type="range"
        min="1"
        max="10"
        data-testid="num-players-input"
        class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-emerald-500"
      />
      <p class="text-[10px] text-gray-500 mt-1">Du bist automatisch Spieler 1.</p>
    </div>
    <div>
      <div class="flex justify-between items-center mb-1">
        <label class="block text-xs text-gray-200">{{ t('dashboard.createGame.bots') }}</label>
        <span class="text-xs font-bold text-blue-400 font-mono">{{ newGameConfig.numAi }}</span>
      </div>
      <input
        [(ngModel)]="newGameConfig.numAi"
        type="range"
        min="0"
        [max]="newGameConfig.numPlayers - 1"
        data-testid="num-ai-input"
        class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-500"
      />
      <p class="text-[10px] text-gray-500 mt-1">Restliche Slots ({{ newGameConfig.numPlayers - 1 - newGameConfig.numAi }}) sind f체r andere menschliche Spieler.</p>
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
    <div>
      <div class="flex justify-between items-center mb-1">
        <label class="block text-xs text-gray-200">{{ t('dashboard.createGame.rounds') }}</label>
        <span class="text-xs font-bold text-emerald-400 font-mono">{{ newGameConfig.numRounds }}</span>
      </div>
      <input
        [(ngModel)]="newGameConfig.numRounds"
        type="range"
        min="10"
        max="50"
        data-testid="num-rounds-input"
        class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-emerald-500"
      />
    </div>
    <div>
      <label class="block text-xs text-gray-200 mb-1">{{ t('dashboard.createGame.aiLevel') }}</label>
      <div class="relative h-[42px]">
        <select
          [(ngModel)]="newGameConfig.aiLevel"
          data-testid="ai-level-select"
          class="w-full h-full px-4 py-2 bg-gray-900/50 border border-gray-600 rounded-lg text-white focus:border-emerald-500 focus:outline-none appearance-none cursor-pointer transition-colors"
        >
          <option value="elementary" class="bg-gray-900 text-white">{{ t('ai.level.elementary') }}</option>
          <option value="middle" class="bg-gray-900 text-white">{{ t('ai.level.middle') }}</option>
          <option value="high" class="bg-gray-900 text-white">{{ t('ai.level.high') }}</option>
        </select>
        <div class="absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none text-gray-400">
          <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
          </svg>
        </div>
      </div>
    </div>
  </div>

  <div class="space-y-3 mb-6 p-3 bg-gray-900/30 rounded-lg border border-gray-700/50">
    <div class="flex items-center gap-3">
      <input
        type="checkbox"
        id="advancedPricingEnabled"
        data-testid="advanced-pricing-checkbox"
        [(ngModel)]="newGameConfig.advancedPricingEnabled"
        class="w-5 h-5 rounded border-gray-600 bg-gray-900 text-emerald-500 focus:ring-emerald-500 focus:ring-offset-gray-900"
      />
      <label for="advancedPricingEnabled" class="text-sm text-gray-200 cursor-pointer">
        {{ t('dashboard.createGame.advancedPricing') }}
      </label>
    </div>

    <div class="flex items-center gap-3 pt-2 border-t border-gray-700/30">
      <input
        type="checkbox"
        id="analyticsEnabled"
        [(ngModel)]="newGameConfig.analyticsEnabled"
        class="w-5 h-5 rounded border-gray-600 bg-gray-900 text-emerald-500 focus:ring-emerald-500 focus:ring-offset-gray-900"
      />
      <label for="analyticsEnabled" class="text-sm text-gray-200 cursor-pointer">
        {{ t('dashboard.createGame.analytics') }}
      </label>
    </div>

    <div class="flex items-center gap-3 pt-2 border-t border-gray-700/30">
      <input
        type="checkbox"
        id="advisorEnabled"
        [(ngModel)]="newGameConfig.advisorEnabled"
        class="w-5 h-5 rounded border-gray-600 bg-gray-900 text-emerald-500 focus:ring-emerald-500 focus:ring-offset-gray-900"
      />
      <label for="advisorEnabled" class="text-sm text-gray-200 cursor-pointer">
        {{ t('dashboard.createGame.advisor') }}
      </label>
    </div>
  </div>

  @if (numHumanPlayers > 1 && isGuest) {
    <div class="mb-6 p-4 bg-blue-900/30 border border-blue-500/50 rounded-2xl flex items-start gap-3 animate-fade-in">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-400 shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <div>
        <p class="text-sm text-blue-100">
          F체r Spiele mit mehreren menschlichen Spielern ist ein kostenloses Konto erforderlich.
        </p>
      </div>
    </div>
  }

  <button
    (click)="onSubmit()"
    [disabled]="isCreatingGame || !newGameConfig.name || !newGameConfig.playerLabel"
    data-testid="create-game-submit"
    class="w-full py-3 bg-emerald-600 hover:bg-emerald-500 disabled:bg-gray-600 disabled:cursor-not-allowed text-white font-bold rounded-lg transition shadow-lg flex items-center justify-center gap-2"
  >
    @if (!isCreatingGame) {
      <span>
        @if (numHumanPlayers > 1 && isGuest) {
          <ng-container>Anmelden zum Erstellen</ng-container>
        } @else {
          {{ t('dashboard.createGame.submit') }}
        }
      </span>
    }
    @if (isCreatingGame) {
      <span class="flex items-center gap-2">
        <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path
            class="opacity-75"
            fill="currentColor"
            d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
          ></path>
        </svg>
        <span>{{ t('dashboard.createGame.creating') }}</span>
      </span>
    }
  </button>

  <div class="mt-4 p-3 bg-gray-900/30 rounded-lg border border-gray-700/50">
    <p class="text-[9px] text-gray-500 leading-relaxed italic">
      <strong>Hinweis:</strong> Spieldaten werden f체r Forschungszwecke und die Spielbalance **anonymisiert** ausgewertet. 
      Details zur Datenverarbeitung finden Sie in der 
      <a routerLink="/privacy" class="text-emerald-500 hover:underline">Datenschutzerkl채rung</a>.
    </p>
  </div>
