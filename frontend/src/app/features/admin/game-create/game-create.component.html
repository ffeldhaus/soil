<!-- File: frontend/src/app/features/admin/game-create/game-create.component.html -->
<div class="create-game-container">
    <mat-card class="create-game-card">
      <mat-card-header>
        <button mat-icon-button (click)="goBack()" matTooltip="Back to Dashboard" class="back-button">
          <mat-icon>arrow_back</mat-icon>
        </button>
        <mat-card-title>Create New Soil Game</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <form [formGroup]="createGameForm" (ngSubmit)="onSubmit()">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Game Name</mat-label>
            <input matInput formControlName="name" required>
            <mat-error *ngIf="createGameForm.get('name')?.hasError('required')">Game name is required.</mat-error>
            <mat-error *ngIf="createGameForm.get('name')?.hasError('minlength')">Name must be at least 3 characters.</mat-error>
            <mat-error *ngIf="createGameForm.get('name')?.hasError('maxlength')">Name is too long (max 100 chars).</mat-error>
          </mat-form-field>
  
          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field-half">
              <mat-label>Number of Rounds</mat-label>
              <input matInput type="number" formControlName="number_of_rounds" required [min]="5" [max]="50">
              <mat-error *ngIf="createGameForm.get('number_of_rounds')?.hasError('required')">Number of rounds is required.</mat-error>
              <mat-error *ngIf="createGameForm.get('number_of_rounds')?.hasError('min') || createGameForm.get('number_of_rounds')?.hasError('max')">
                Rounds must be between 5 and 50.
              </mat-error>
            </mat-form-field>
  
            <mat-form-field appearance="outline" class="form-field-half">
              <mat-label>Max Players in Game</mat-label>
              <input matInput type="number" formControlName="max_players" required [min]="minPlayersRequired" [max]="10">
              <mat-error *ngIf="createGameForm.get('max_players')?.hasError('required')">Max players is required.</mat-error>
              <mat-error *ngIf="createGameForm.get('max_players')?.hasError('min') || createGameForm.get('max_players')?.hasError('max')">
                Max players must be between {{ minPlayersRequired }} and 10.
              </mat-error>
            </mat-form-field>
          </div>
  
          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field-half">
              <mat-label>Number of Human Players</mat-label>
              <input matInput type="number" formControlName="requested_player_slots" required min="0"
                     [max]="createGameForm.get('max_players')?.value || maxPlayersLimit">
              <mat-error *ngIf="createGameForm.get('requested_player_slots')?.hasError('required')">Human players count is required.</mat-error>
              <mat-error *ngIf="createGameForm.get('requested_player_slots')?.hasError('min')">Cannot be negative.</mat-error>
              <mat-error *ngIf="createGameForm.get('requested_player_slots')?.hasError('max')">Cannot exceed Max Players.</mat-error>
            </mat-form-field>
  
            <mat-form-field appearance="outline" class="form-field-half">
              <mat-label>Number of AI Players</mat-label>
              <input matInput type="number" formControlName="ai_player_count" required min="0"
                     [max]="(createGameForm.get('max_players')?.value || maxPlayersLimit) - (createGameForm.get('requested_player_slots')?.value || 0)">
              <mat-error *ngIf="createGameForm.get('ai_player_count')?.hasError('required')">AI players count is required.</mat-error>
              <mat-error *ngIf="createGameForm.get('ai_player_count')?.hasError('min')">Cannot be negative.</mat-error>
              <mat-error *ngIf="createGameForm.get('ai_player_count')?.hasError('max')">Total players cannot exceed Max Players for game.</mat-error>
            </mat-form-field>
          </div>
          
          <div *ngIf="createGameForm.hasError('totalPlayersExceedMax')" class="form-error">
            {{ createGameForm.getError('totalPlayersExceedMax')?.message }}
          </div>
          <div *ngIf="createGameForm.hasError('totalPlayersBelowMin')" class="form-error">
            {{ createGameForm.getError('totalPlayersBelowMin')?.message }}
          </div>
  
          <div class="actions-row">
            <button mat-stroked-button type="button" (click)="goBack()">Cancel</button>
            <button mat-flat-button color="primary" type="submit" [disabled]="isSubmitting() || createGameForm.invalid">
              {{ isSubmitting() ? 'Creating Game...' : 'Create Game' }}
            </button>
          </div>
        </form>
      </mat-card-content>
    </mat-card>
  </div>